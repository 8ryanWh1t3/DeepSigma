# Constitution

This directory is the **immutable contract surface** of Sigma OVERWATCH.

Everything reachable from `reference/` defines what external consumers, SDK packages, and governance pipelines may depend on. Changing a contract is allowed — silently breaking one is not.

## What Lives Here

| Path | Source of Truth | What It Is |
| --- | --- | --- |
| `schemas/` | `src/core/schemas/` | 26 JSON Schema contracts (episodes, claims, drift, FEEDS, etc.) |
| `governance/` | `enterprise/docs/governance/` | Policy baseline, policy version, label policy |
| `manifesto.md` | `docs/manifesto.md` | Reference layer manifesto (three failures + proof) |
| `abp_v1.json` | `edge/abp_v1.json` | Authority Boundary Primitive v1 contract |
| `VERSION` | Generated from `pyproject.toml` | Single canonical version truth |
| `schema_manifest.json` | Generated by `constitution_gate.py` | SHA-256 fingerprint of every schema |

## Rules

1. **No silent breaks.** If a schema hash changes, `constitution_gate.py` fails CI until the manifest is regenerated with `--init` and a `CHANGELOG.md` entry is added.
2. **Annotate every change.** Changelog entries must include one of: `BREAKING:`, `COMPATIBLE:`, or `ADDITIVE:`.
3. **Version parity.** `POLICY_VERSION.txt` major.minor must match `pyproject.toml` major.minor. The `VERSION` file is generated — never hand-edited.
4. **GPE by construction.** The constitution gate runs GPE on all resolved paths. Environment-specific terms are structurally excluded.

## Changing a Contract

```bash
# 1. Make your schema/policy change
# 2. Add a CHANGELOG.md entry with annotation
# 3. Regenerate the manifest
python scripts/constitution_gate.py --init
# 4. Commit all changes together
# 5. CI validates on push
```

## Enforcement

- CI: `.github/workflows/constitution_gate.yml`
- Local: `make constitution-gate`
- Script: `python scripts/constitution_gate.py`
